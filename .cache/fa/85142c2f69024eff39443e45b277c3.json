{"id":"CNpF","dependencies":[{"name":"/Users/kmadasu/kishore/trainings/javascript-gt/gautam/poseanimator/package.json","includedInParent":true,"mtime":1636789466000},{"name":"paper","loc":{"line":18,"column":23},"parent":"/Users/kmadasu/kishore/trainings/javascript-gt/gautam/poseanimator/illustrationGen/skeleton.js","resolved":"/Users/kmadasu/kishore/trainings/javascript-gt/gautam/poseanimator/node_modules/paper/dist/paper-full.js"},{"name":"../utils/svgUtils","loc":{"line":19,"column":25},"parent":"/Users/kmadasu/kishore/trainings/javascript-gt/gautam/poseanimator/illustrationGen/skeleton.js","resolved":"/Users/kmadasu/kishore/trainings/javascript-gt/gautam/poseanimator/utils/svgUtils.js"},{"name":"../utils/mathUtils","loc":{"line":20,"column":26},"parent":"/Users/kmadasu/kishore/trainings/javascript-gt/gautam/poseanimator/illustrationGen/skeleton.js","resolved":"/Users/kmadasu/kishore/trainings/javascript-gt/gautam/poseanimator/utils/mathUtils.js"},{"name":"../utils/colorUtils","loc":{"line":21,"column":27},"parent":"/Users/kmadasu/kishore/trainings/javascript-gt/gautam/poseanimator/illustrationGen/skeleton.js","resolved":"/Users/kmadasu/kishore/trainings/javascript-gt/gautam/poseanimator/utils/colorUtils.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.Skeleton=exports.Bone=exports.allPartNames=exports.facePartName2Index=void 0;var t=s(require(\"paper\")),e=require(\"../utils/svgUtils\"),i=require(\"../utils/mathUtils\"),o=require(\"../utils/colorUtils\");function r(){if(\"function\"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function s(t){if(t&&t.__esModule)return t;if(null===t||\"object\"!=typeof t&&\"function\"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var h=o?Object.getOwnPropertyDescriptor(t,s):null;h&&(h.get||h.set)?Object.defineProperty(i,s,h):i[s]=t[s]}return i.default=t,e&&e.set(t,i),i}function h(t){return f(t)||a(t)||p(t)||n()}function n(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function p(t,e){if(t){if(\"string\"==typeof t)return l(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return\"Object\"===i&&t.constructor&&(i=t.constructor.name),\"Map\"===i||\"Set\"===i?Array.from(i):\"Arguments\"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?l(t,e):void 0}}function a(t){if(\"undefined\"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function f(t){if(Array.isArray(t))return l(t)}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}function L(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function w(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function g(t,e,i){return e&&w(t.prototype,e),i&&w(t,i),t}var c=.1,u=.8,b=[\"leftAnkle\",\"leftKnee\",\"leftHip\",\"leftWrist\",\"leftElbow\",\"leftShoulder\",\"rightAnkle\",\"rightKnee\",\"rightHip\",\"rightWrist\",\"rightElbow\",\"rightShoulder\",\"leftEar\",\"rightEar\"],d={topMid:10,rightTop0:67,rightTop1:54,leftTop0:297,leftTop1:284,rightJaw0:21,rightJaw1:162,rightJaw2:127,rightJaw3:234,rightJaw4:132,rightJaw5:172,rightJaw6:150,rightJaw7:176,jawMid:152,leftJaw7:400,leftJaw6:379,leftJaw5:397,leftJaw4:361,leftJaw3:454,leftJaw2:356,leftJaw1:389,leftJaw0:251,rightBrow0:46,rightBrow1:53,rightBrow2:52,rightBrow3:65,rightBrow4:55,leftBrow4:285,leftBrow3:295,leftBrow2:282,leftBrow1:283,leftBrow0:276,nose0:6,nose1:197,nose2:195,nose3:5,rightNose0:48,rightNose1:220,nose4:4,leftNose1:440,leftNose0:278,rightEye0:33,rightEye1:160,rightEye2:158,rightEye3:133,rightEye4:153,rightEye5:144,leftEye3:362,leftEye2:385,leftEye1:387,leftEye0:263,leftEye5:373,leftEye4:380,rightMouthCorner:61,rightUpperLipTop0:40,rightUpperLipTop1:37,upperLipTopMid:0,leftUpperLipTop1:267,leftUpperLipTop0:270,leftMouthCorner:291,leftLowerLipBottom0:321,leftLowerLipBottom1:314,lowerLipBottomMid:17,rightLowerLipBottom1:84,rightLowerLipBottom0:91,rightMiddleLip:78,rightUpperLipBottom1:81,upperLipBottomMid:13,leftUpperLipBottom1:311,leftMiddleLip:308,leftLowerLipTop0:402,lowerLipTopMid:14,rightLowerLipTop0:178};exports.facePartName2Index=d;var y=[\"topMid\",\"rightTop0\",\"rightTop1\",\"leftTop0\",\"leftTop1\",\"rightJaw0\",\"rightJaw1\",\"rightJaw2\",\"rightJaw3\",\"rightJaw4\",\"rightJaw5\",\"rightJaw6\",\"rightJaw7\",\"jawMid\",\"leftJaw7\",\"leftJaw6\",\"leftJaw5\",\"leftJaw4\",\"leftJaw3\",\"leftJaw2\",\"leftJaw1\",\"leftJaw0\",\"rightBrow0\",\"rightBrow1\",\"rightBrow2\",\"rightBrow3\",\"rightBrow4\",\"leftBrow4\",\"leftBrow3\",\"leftBrow2\",\"leftBrow1\",\"leftBrow0\",\"nose0\",\"nose1\",\"nose2\",\"nose3\",\"rightNose0\",\"rightNose1\",\"nose4\",\"leftNose1\",\"leftNose0\",\"rightEye0\",\"rightEye1\",\"rightEye2\",\"rightEye3\",\"rightEye4\",\"rightEye5\",\"leftEye3\",\"leftEye2\",\"leftEye1\",\"leftEye0\",\"leftEye5\",\"leftEye4\",\"rightMouthCorner\",\"rightUpperLipTop0\",\"rightUpperLipTop1\",\"upperLipTopMid\",\"leftUpperLipTop1\",\"leftUpperLipTop0\",\"leftMouthCorner\",\"leftLowerLipBottom0\",\"leftLowerLipBottom1\",\"lowerLipBottomMid\",\"rightLowerLipBottom1\",\"rightLowerLipBottom0\",\"rightMiddleLip\",\"rightUpperLipBottom1\",\"upperLipBottomMid\",\"leftUpperLipBottom1\",\"leftMiddleLip\",\"leftLowerLipTop0\",\"lowerLipTopMid\",\"rightLowerLipTop0\"],R=b.concat(y);exports.allPartNames=R;var B=function(){function e(){L(this,e)}return g(e,[{key:\"set\",value:function(t,e,i,r){return this.name=\"\".concat(t.name,\"-\").concat(e.name),this.kp0=t,this.kp1=e,this.skeleton=i,this.type=r,this.boneColor=o.ColorUtils.fromStringHash(this.name),this.boneColor.saturation+=.5,this}},{key:\"getPointTransform\",value:function(e){var o=this.kp1.position.subtract(this.kp0.position).normalize(),r=o.clone();r.angle+=90;var s=i.MathUtils.getClosestPointOnSegment(this.kp0.position,this.kp1.position,e),h=e.subtract(s),n=h.dot(o),p=h.dot(r),a=this.kp0.position.subtract(this.kp1.position).length,f=s.subtract(this.kp0.position).length/a;return{transform:new t.default.Point(n,p),anchorPerc:f}}},{key:\"transform\",value:function(t){if(this.kp1.currentPosition&&this.kp0.currentPosition){var e=\"face\"===this.type?this.skeleton.currentFaceScale:this.skeleton.currentBodyScale,i=this.kp1.currentPosition.subtract(this.kp0.currentPosition).normalize(),o=i.clone();return o.angle+=90,this.kp0.currentPosition.multiply(1-t.anchorPerc).add(this.kp1.currentPosition.multiply(t.anchorPerc)).add(i.multiply(t.transform.x*e)).add(o.multiply(t.transform.y*e))}}}]),e}();function E(t,i){return{position:e.SVGUtils.findFirstItemWithPrefix(t,i).bounds.center,name:i}}function m(e,i){if(!e||!e.keypoints)return null;var o=e.keypoints.find(function(t){return t.part===i});return{position:new t.default.Point(o.position.x,o.position.y),score:o.score}}function J(e,i){return!e||!e.scaledMesh||e.scaledMesh.length,new t.default.Point(e.positions[2*i],e.positions[2*i+1])}exports.Bone=B;var M=function(){function o(t){var r=this;L(this,o);var s=e.SVGUtils.findFirstItemWithPrefix(t.project,\"skeleton\"),h=E(s,\"leftAnkle\"),n=E(s,\"leftKnee\"),p=E(s,\"leftHip\"),a=E(s,\"leftWrist\"),f=E(s,\"leftElbow\"),l=E(s,\"leftShoulder\"),w=E(s,\"rightAnkle\"),g=E(s,\"rightKnee\"),c=E(s,\"rightHip\"),u=E(s,\"rightWrist\"),b=E(s,\"rightElbow\"),d=E(s,\"rightShoulder\"),y=E(s,\"topMid\"),R=E(s,\"rightTop0\"),m=E(s,\"rightTop1\"),J=E(s,\"leftTop0\"),M=E(s,\"leftTop1\"),T=E(s,\"leftJaw2\"),k=E(s,\"leftJaw3\"),v=E(s,\"leftJaw4\"),P=E(s,\"leftJaw5\"),U=E(s,\"leftJaw6\"),N=E(s,\"leftJaw7\"),S=E(s,\"jawMid\"),C=E(s,\"rightJaw2\"),x=E(s,\"rightJaw3\"),F=E(s,\"rightJaw4\"),j=E(s,\"rightJaw5\"),H=E(s,\"rightJaw6\"),O=E(s,\"rightJaw7\"),A=E(s,\"nose0\"),W=E(s,\"nose1\"),K=E(s,\"nose2\"),V=E(s,\"nose3\"),I=E(s,\"nose4\"),G=E(s,\"leftNose0\"),D=E(s,\"leftNose1\"),q=E(s,\"rightNose0\"),z=E(s,\"rightNose1\"),_=E(s,\"leftEye0\"),$=E(s,\"leftEye1\"),Q=E(s,\"leftEye2\"),X=E(s,\"leftEye3\"),Y=E(s,\"leftEye4\"),Z=E(s,\"leftEye5\"),tt=E(s,\"rightEye0\"),et=E(s,\"rightEye1\"),it=E(s,\"rightEye2\"),ot=E(s,\"rightEye3\"),rt=E(s,\"rightEye4\"),st=E(s,\"rightEye5\"),ht=E(s,\"leftBrow0\"),nt=E(s,\"leftBrow1\"),pt=E(s,\"leftBrow2\"),at=E(s,\"leftBrow3\"),ft=E(s,\"leftBrow4\"),lt=E(s,\"rightBrow0\"),Lt=E(s,\"rightBrow1\"),wt=E(s,\"rightBrow2\"),gt=E(s,\"rightBrow3\"),ct=E(s,\"rightBrow4\"),ut=E(s,\"leftMouthCorner\"),bt=E(s,\"leftUpperLipTop0\"),dt=E(s,\"leftUpperLipTop1\"),yt=E(s,\"upperLipTopMid\"),Rt=E(s,\"rightMouthCorner\"),Bt=E(s,\"rightUpperLipTop0\"),Et=E(s,\"rightUpperLipTop1\"),mt=E(s,\"rightMiddleLip\"),Jt=E(s,\"rightUpperLipBottom1\"),Mt=E(s,\"leftMiddleLip\"),Tt=E(s,\"leftUpperLipBottom1\"),kt=E(s,\"upperLipBottomMid\"),vt=E(s,\"rightLowerLipTop0\"),Pt=E(s,\"leftLowerLipTop0\"),Ut=E(s,\"lowerLipTopMid\"),Nt=E(s,\"rightLowerLipBottom0\"),St=E(s,\"rightLowerLipBottom1\"),Ct=E(s,\"leftLowerLipBottom0\"),xt=E(s,\"leftLowerLipBottom1\"),Ft=E(s,\"lowerLipBottomMid\");this.bLeftShoulderRightShoulder=(new B).set(l,d,this,\"body\"),this.bRightShoulderRightHip=(new B).set(d,c,this,\"body\"),this.bLeftHipRightHip=(new B).set(p,c,this,\"body\"),this.bLeftShoulderLeftHip=(new B).set(l,p,this,\"body\"),this.bLeftShoulderLeftElbow=(new B).set(l,f,this,\"body\"),this.bLeftElbowLeftWrist=(new B).set(f,a,this,\"body\"),this.bRightShoulderRightElbow=(new B).set(d,b,this,\"body\"),this.bRightElbowRightWrist=(new B).set(b,u,this,\"body\"),this.bLeftHipLeftKnee=(new B).set(p,n,this,\"body\"),this.bLeftKneeLeftAnkle=(new B).set(n,h,this,\"body\"),this.bRightHipRightKnee=(new B).set(c,g,this,\"body\"),this.bRightKneeRightAnkle=(new B).set(g,w,this,\"body\"),this.bTopMidRightTop0=(new B).set(y,R,this,\"face\"),this.bTopMidLeftTop0=(new B).set(y,J,this,\"face\"),this.bLeftTop0LeftTop1=(new B).set(J,M,this,\"face\"),this.bLeftTop1LeftJaw2=(new B).set(M,T,this,\"face\"),this.bLeftJaw2LeftJaw3=(new B).set(T,k,this,\"face\"),this.bLeftJaw3LeftJaw4=(new B).set(k,v,this,\"face\"),this.bLeftJaw4LeftJaw5=(new B).set(v,P,this,\"face\"),this.bLeftJaw5LeftJaw6=(new B).set(P,U,this,\"face\"),this.bLeftJaw6LeftJaw7=(new B).set(U,N,this,\"face\"),this.bLeftJaw7JawMid=(new B).set(N,S,this,\"face\"),this.bRightTop0RightTop1=(new B).set(R,m,this,\"face\"),this.bRightTop1RightJaw2=(new B).set(m,C,this,\"face\"),this.bRightJaw2RightJaw3=(new B).set(C,x,this,\"face\"),this.bRightJaw3RightJaw4=(new B).set(x,F,this,\"face\"),this.bRightJaw4RightJaw5=(new B).set(F,j,this,\"face\"),this.bRightJaw5RightJaw6=(new B).set(j,H,this,\"face\"),this.bRightJaw6RightJaw7=(new B).set(H,O,this,\"face\"),this.bRightJaw7JawMid=(new B).set(O,S,this,\"face\"),this.bLeftEye0LeftEye1=(new B).set(_,$,this,\"face\"),this.bLeftEye1LeftEye2=(new B).set($,Q,this,\"face\"),this.bLeftEye2LeftEye3=(new B).set(Q,X,this,\"face\"),this.bLeftEye3LeftEye4=(new B).set(X,Y,this,\"face\"),this.bLeftEye4LeftEye5=(new B).set(Y,Z,this,\"face\"),this.bLeftEye5LeftEye0=(new B).set(Z,_,this,\"face\"),this.bRightEye0RightEye1=(new B).set(tt,et,this,\"face\"),this.bRightEye1RightEye2=(new B).set(et,it,this,\"face\"),this.bRightEye2RightEye3=(new B).set(it,ot,this,\"face\"),this.bRightEye3RightEye4=(new B).set(ot,rt,this,\"face\"),this.bRightEye4RightEye5=(new B).set(rt,st,this,\"face\"),this.bRightEye5RightEye0=(new B).set(st,tt,this,\"face\"),this.bLeftBrow0LeftBrow1=(new B).set(ht,nt,this,\"face\"),this.bLeftBrow1LeftBrow2=(new B).set(nt,pt,this,\"face\"),this.bLeftBrow2LeftBrow3=(new B).set(pt,at,this,\"face\"),this.bLeftBrow3LeftBrow4=(new B).set(at,ft,this,\"face\"),this.bRightBrow0RightBrow1=(new B).set(lt,Lt,this,\"face\"),this.bRightBrow1RightBrow2=(new B).set(Lt,wt,this,\"face\"),this.bRightBrow2RightBrow3=(new B).set(wt,gt,this,\"face\"),this.bRightBrow3RightBrow4=(new B).set(gt,ct,this,\"face\"),this.bNose0Nose1=(new B).set(A,W,this,\"face\"),this.bNose1Nose2=(new B).set(W,K,this,\"face\"),this.bNose2Nose3=(new B).set(K,V,this,\"face\"),this.bNose3Nose4=(new B).set(V,I,this,\"face\"),this.bLeftNose0LeftNose1=(new B).set(G,D,this,\"face\"),this.bLeftNose1Nose4=(new B).set(D,I,this,\"face\"),this.bRightNose0RightNose1=(new B).set(q,z,this,\"face\"),this.bRightNose1Nose4=(new B).set(z,I,this,\"face\"),this.bLeftMouthCornerLeftUpperLipTop0=(new B).set(ut,bt,this,\"face\"),this.bLeftUpperLipTop0LeftUpperLipTop1=(new B).set(bt,dt,this,\"face\"),this.bLeftUpperLipTop1UpperLipTopMid=(new B).set(dt,yt,this,\"face\"),this.bRigthMouthCornerRigthUpperLipTop0=(new B).set(Rt,Bt,this,\"face\"),this.bRigthUpperLipTop0RigthUpperLipTop1=(new B).set(Bt,Et,this,\"face\"),this.bRigthUpperLipTop1UpperLipTopMid=(new B).set(Et,yt,this,\"face\"),this.bLeftMouthCornerLeftMiddleLip=(new B).set(ut,Mt,this,\"face\"),this.bLeftMiddleLipLeftUpperLipBottom1=(new B).set(Mt,Tt,this,\"face\"),this.bLeftUpperLipBottom1UpperLipBottomMid=(new B).set(Tt,kt,this,\"face\"),this.bRightMouthCornerRightMiddleLip=(new B).set(Rt,mt,this,\"face\"),this.bRightMiddleLipRightUpperLipBottom1=(new B).set(mt,Jt,this,\"face\"),this.bRightUpperLipBottom1UpperLipBototmMid=(new B).set(Jt,kt,this,\"face\"),this.bLeftMiddleLipLeftLowerLipTop0=(new B).set(Mt,Pt,this,\"face\"),this.bLeftLowerLipTop0LowerLipTopMid=(new B).set(Pt,Ut,this,\"face\"),this.bRightMiddleLipRightLowerLipTop0=(new B).set(mt,vt,this,\"face\"),this.bRightLowerLipTop0LowerLipTopMid=(new B).set(vt,Ut,this,\"face\"),this.bLeftMouthCornerLeftLowerLipBottom0=(new B).set(ut,Ct,this,\"face\"),this.bLeftLowerLipBottom0LeftLowerLipBottom1=(new B).set(Ct,xt,this,\"face\"),this.bLeftLowerLipBottom1LowerLipBottomMid=(new B).set(xt,Ft,this,\"face\"),this.bRightMouthCornerRightLowerLipBottom0=(new B).set(Rt,Nt,this,\"face\"),this.bRightLowerLipBottom0RightLowerLipBottom1=(new B).set(Nt,St,this,\"face\"),this.bRightLowerLipBottom1LowerLipBottomMid=(new B).set(St,Ft,this,\"face\"),this.faceBones=[this.bTopMidRightTop0,this.bRightTop0RightTop1,this.bTopMidLeftTop0,this.bLeftTop0LeftTop1,this.bLeftTop1LeftJaw2,this.bLeftJaw2LeftJaw3,this.bLeftJaw3LeftJaw4,this.bLeftJaw4LeftJaw5,this.bLeftJaw5LeftJaw6,this.bLeftJaw6LeftJaw7,this.bLeftJaw7JawMid,this.bRightTop1RightJaw2,this.bRightJaw2RightJaw3,this.bRightJaw3RightJaw4,this.bRightJaw4RightJaw5,this.bRightJaw5RightJaw6,this.bRightJaw6RightJaw7,this.bRightJaw7JawMid,this.bLeftEye0LeftEye1,this.bLeftEye1LeftEye2,this.bLeftEye2LeftEye3,this.bLeftEye3LeftEye4,this.bLeftEye4LeftEye5,this.bLeftEye5LeftEye0,this.bRightEye0RightEye1,this.bRightEye1RightEye2,this.bRightEye2RightEye3,this.bRightEye3RightEye4,this.bRightEye4RightEye5,this.bRightEye5RightEye0,this.bLeftBrow0LeftBrow1,this.bLeftBrow1LeftBrow2,this.bLeftBrow2LeftBrow3,this.bLeftBrow3LeftBrow4,this.bRightBrow0RightBrow1,this.bRightBrow1RightBrow2,this.bRightBrow2RightBrow3,this.bRightBrow3RightBrow4,this.bNose0Nose1,this.bNose1Nose2,this.bNose2Nose3,this.bNose3Nose4,this.bLeftNose0LeftNose1,this.bLeftNose1Nose4,this.bRightNose0RightNose1,this.bRightNose1Nose4,this.bLeftMouthCornerLeftUpperLipTop0,this.bLeftUpperLipTop0LeftUpperLipTop1,this.bLeftUpperLipTop1UpperLipTopMid,this.bRigthMouthCornerRigthUpperLipTop0,this.bRigthUpperLipTop0RigthUpperLipTop1,this.bRigthUpperLipTop1UpperLipTopMid,this.bLeftMouthCornerLeftMiddleLip,this.bLeftMiddleLipLeftUpperLipBottom1,this.bLeftUpperLipBottom1UpperLipBottomMid,this.bRightMouthCornerRightMiddleLip,this.bRightMiddleLipRightUpperLipBottom1,this.bRightUpperLipBottom1UpperLipBototmMid,this.bLeftMiddleLipLeftLowerLipTop0,this.bLeftLowerLipTop0LowerLipTopMid,this.bRightMiddleLipRightLowerLipTop0,this.bRightLowerLipTop0LowerLipTopMid,this.bLeftMouthCornerLeftLowerLipBottom0,this.bLeftLowerLipBottom0LeftLowerLipBottom1,this.bLeftLowerLipBottom1LowerLipBottomMid,this.bRightMouthCornerRightLowerLipBottom0,this.bRightLowerLipBottom0RightLowerLipBottom1,this.bRightLowerLipBottom1LowerLipBottomMid],this.bodyBones=[this.bLeftShoulderRightShoulder,this.bRightShoulderRightHip,this.bLeftHipRightHip,this.bLeftShoulderLeftHip,this.bLeftShoulderLeftElbow,this.bLeftElbowLeftWrist,this.bRightShoulderRightElbow,this.bRightElbowRightWrist,this.bLeftHipLeftKnee,this.bLeftKneeLeftAnkle,this.bRightHipRightKnee,this.bRightKneeRightAnkle],this.bones=this.faceBones.concat(this.bodyBones),this.secondaryBones=[],this.parts={},this.bodyLen0=this.getTotalBoneLength(this.bodyBones),this.faceLen0=this.getTotalBoneLength(this.faceBones),this.boneGroups={torso:[this.bLeftShoulderRightShoulder,this.bRightShoulderRightHip,this.bLeftHipRightHip,this.bLeftShoulderLeftHip],leftLeg:[this.bLeftHipLeftKnee,this.bLeftKneeLeftAnkle],rightLeg:[this.bRightHipRightKnee,this.bRightKneeRightAnkle],leftArm:[this.bLeftShoulderLeftElbow,this.bLeftElbowLeftWrist],rightArm:[this.bRightElbowRightWrist,this.bRightShoulderRightElbow],face:this.faceBones},this.faceBones.forEach(function(t){[t.kp0,t.kp1].forEach(function(t){t.baseTransFunc=i.MathUtils.getTransformFunc(r.bLeftJaw2LeftJaw3.kp0.position,r.bRightJaw2RightJaw3.kp0.position,t.position)})})}return g(o,[{key:\"update\",value:function(t,e){var i=this;if(t.score<c)this.isValid=!1;else if(this.isValid=this.updatePoseParts(t),this.isValid&&(this.isValid=this.updateFaceParts(e),this.isValid)){this.bones.forEach(function(t){var e=i.parts[t.kp0.name],o=i.parts[t.kp1.name];t.kp0.currentPosition=e.position,t.kp1.currentPosition=o.position,t.score=(e.score+o.score)/2,t.latestCenter=t.kp1.currentPosition.add(t.kp0.currentPosition).divide(2)});var o=this.bNose3Nose4.kp1.currentPosition;this.secondaryBones.forEach(function(t){t.kp0.currentPosition=t.kp0.transformFunc(t.parent.kp0.currentPosition,o),t.kp1.currentPosition=t.kp1.transformFunc(t.parent.kp1.currentPosition,o),t.score=t.parent.score,t.latestCenter=t.kp1.currentPosition.add(t.kp0.currentPosition).divide(2)}),this.currentFaceScale=this.getTotalBoneLength(this.faceBones)/this.faceLen0,this.currentBodyScale=this.getTotalBoneLength(this.bodyBones)/this.bodyLen0,this.isValid=!0}}},{key:\"updatePoseParts\",value:function(t){var e=this;return b.forEach(function(i){var o=m(t,i),r=e.parts[i]||o,s=r.score/(o.score+r.score),h=o.score/(o.score+r.score),n=r.position.multiply(s).add(o.position.multiply(h));e.parts[i]={position:n,score:r.score*s+o.score*h}}),!(!this.parts.rightEar||!this.parts.leftEar)}},{key:\"updateFaceParts\",value:function(t){var e=this,o=this.parts.leftEar.position,r=this.parts.rightEar.position;if(t&&t.positions&&t.positions.length&&t.faceInViewConfidence>u){for(var s=0;s<y.length;s++){var h=y[s],n=J(t,s);n&&(this.parts[h]={position:n,score:t.faceInViewConfidence})}this.leftEarP2FFunc=i.MathUtils.getTransformFunc(o,r,this.parts.leftJaw2.position),this.rightEarP2FFunc=i.MathUtils.getTransformFunc(o,r,this.parts.rightJaw2.position)}else{var p=this.leftEarP2FFunc?this.leftEarP2FFunc(o,r):o,a=this.rightEarP2FFunc?this.rightEarP2FFunc(o,r):r;this.currentFaceScale=this.currentBodyScale,this.faceBones.forEach(function(t){[t.kp0,t.kp1].forEach(function(t){e.parts[t.name]={position:t.baseTransFunc(p,a),score:1}})})}return!0}},{key:\"findBoneGroup\",value:function(t){var e=this,o={};Object.keys(this.boneGroups).forEach(function(r){var s=1/0;e.boneGroups[r].forEach(function(e){var o=i.MathUtils.getClosestPointOnSegment(e.kp0.position,e.kp1.position,t).getDistance(t);s=Math.min(s,o)}),o[r]=s});var r=Math.min.apply(Math,h(Object.values(o))),s=[];return Object.keys(o).forEach(function(t){o[t]<=r&&s.push(e.boneGroups[t])}),s.flatten()}},{key:\"getTotalBoneLength\",value:function(t){var e=0;return t.forEach(function(t){var i=(t.kp0.currentPosition||t.kp0.position).subtract(t.kp1.currentPosition||t.kp1.position);e+=i.length}),e}},{key:\"debugDraw\",value:function(t){var e=new t.Group;t.project.activeLayer.addChild(e),this.bones.forEach(function(i){var o=new t.Path({segments:[i.kp0.currentPosition,i.kp1.currentPosition],strokeWidth:2,strokeColor:i.boneColor});e.addChild(o)})}},{key:\"debugDrawLabels\",value:function(t){var e=new t.Group;t.project.activeLayer.addChild(e),this.bones.forEach(function(i){var o=function(i,o){var r=new t.PointText({point:[i.currentPosition.x,i.currentPosition.y],content:o,fillColor:\"black\",fontSize:7});e.addChild(r)};o(i.kp0,i.kp0.name),o(i.kp1,i.kp1.name)})}},{key:\"reset\",value:function(){this.parts=[]}}],[{key:\"getCurrentPosition\",value:function(e){var i=new t.default.Point;return Object.keys(e.skinning).forEach(function(t){var o=e.skinning[t];i=i.add(o.bone.transform(o.transform).multiply(o.weight))}),i}},{key:\"flipPose\",value:function(t){t.keypoints.forEach(function(t){t.part&&t.part.startsWith(\"left\")?t.part=\"right\"+t.part.substring(\"left\".length,t.part.length):t.part&&t.part.startsWith(\"right\")&&(t.part=\"left\"+t.part.substring(\"right\".length,t.part.length))})}},{key:\"flipFace\",value:function(t){Object.keys(d).forEach(function(e){if(e.startsWith(\"left\")){var i=\"right\"+e.substr(\"left\".length,e.length),o=t.scaledMesh[d[e]];t.scaledMesh[d[e]]=t.scaledMesh[d[i]],t.scaledMesh[d[i]]=o}})}},{key:\"getBoundingBox\",value:function(t){var e=1e5,i=-1e5,o=1e5,r=-1e5,s=function(t,s){e=Math.min(t,e),i=Math.max(t,i),o=Math.min(s,o),r=Math.max(s,r)};return t.frames.forEach(function(t){t.pose.keypoints.forEach(function(t){s(t.position.x,t.position.y)});for(var e=t.face.positions,i=0;i<e.length;i+=2)s(e[i],e[i+1])}),[e,i,o,r]}},{key:\"translatePose\",value:function(t,e){t.frames.forEach(function(t){t.pose.keypoints.forEach(function(t){t.position.x+=e.x,t.position.y+=e.y});for(var i=t.face.positions,o=0;o<i.length;o+=2)i[o]+=e.x,i[o+1]+=e.y})}},{key:\"resizePose\",value:function(t,e,i){t.frames.forEach(function(t){t.pose.keypoints.forEach(function(t){t.position.x=e.x+(t.position.x-e.x)*i.x,t.position.y=e.y+(t.position.y-e.y)*i.y});for(var o=t.face.positions,r=0;r<o.length;r+=2)o[r]=e.x+(o[r]-e.x)*i.x,o[r+1]=e.y+(o[r+1]-e.y)*i.y})}},{key:\"toFaceFrame\",value:function(t){for(var e={positions:[],faceInViewConfidence:t.faceInViewConfidence},i=0;i<y.length;i++){var o=y[i],r=t.scaledMesh[d[o]];e.positions.push(r[0]),e.positions.push(r[1])}return e}}]),o}();exports.Skeleton=M;"},"sourceMaps":null,"error":null,"hash":"70de822ebbb933b3b4775ac03a589378","cacheData":{"env":{}}}